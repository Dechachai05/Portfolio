<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="utf-8" />
<title>Dechachai Portfolio</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
  html, body { height: 100%; margin: 0; overflow: hidden; }
  canvas { display: block; }

  #navbar {
    position: absolute;
    top: 25px;
    left: 25px;
    text-align: left;
    z-index: 100;
    padding: 15px;
    border-radius: 10px;
    background-color: rgba(0,0,0,0.6);
  }

  #navbar button {
    background: linear-gradient(145deg, #007bff, #0056b3);
    color: white;
    font-family: 'Arial', sans-serif;
    font-weight: bold;
    font-size: 16px;
    border: none;
    padding: 12px 25px;
    margin: 5px 0;
    cursor: pointer;
    border-radius: 30px;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
    transition: all 0.3s ease-in-out;
    display: block;
  }

  #navbar button:hover {
    background: linear-gradient(145deg, #0056b3, #007bff);
    box-shadow: 0 8px 15px rgba(0, 0, 0, 0.4);
    transform: translateY(-2px);
  }

  #label {
    position: absolute;
    bottom: 25px;
    left: 50%;
    transform: translateX(-50%);
    color: white;
    font-size: 24px;
    font-weight: bold;
    text-shadow: 0 0 10px black;
    z-index: 100;
  }

  #tip {
    position: absolute;
    top: 10px;
    left: 50%;
    transform: translateX(-50%);
    color: #ffd700;
    font-size: 20px;
    font-weight: bold;
    text-shadow: 0 0 10px black;
    animation: pulseTip 2s infinite;
    z-index: 100;
  }

  @keyframes pulseTip {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
  }
</style>

<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
</head>
<body>

<div id="navbar">
  <button data-target="1">About Me</button>
  <button data-target="2">Skill</button>
  <button data-target="3">Project</button>
  <button data-target="4">Contact</button>
</div>

<div id="tip">üí° ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î!</div>
<div id="label">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏...</div>

<script>
const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera(60, innerWidth / innerHeight, 0.1, 100);
camera.position.set(0, 1.2, 3);

const renderer = new THREE.WebGLRenderer({ antialias: true });
renderer.setSize(innerWidth, innerHeight);
renderer.outputEncoding = THREE.sRGBEncoding;
renderer.shadowMap.enabled = true;
document.body.appendChild(renderer.domElement);

const controls = new THREE.OrbitControls(camera, renderer.domElement);
controls.enableDamping = true;
controls.dampingFactor = 0.05;

// Light
const hemi = new THREE.HemisphereLight(0xffffff, 0x111111, 0.5);
scene.add(hemi);
const dir = new THREE.DirectionalLight(0xffffff, 1.5);
dir.position.set(5, 10, 5);
dir.castShadow = true;
scene.add(dir);

// Ground
const ground = new THREE.Mesh(
  new THREE.PlaneBufferGeometry(50, 50),
  new THREE.MeshStandardMaterial({ color: 0x000000, roughness: 0.15, metalness: 0.8 })
);
ground.rotation.x = -Math.PI / 2;
ground.receiveShadow = true;
scene.add(ground);

// Environment
new THREE.TextureLoader().load(
  'https://raw.githubusercontent.com/Dechachai05/Portfolio/main/dikhololo_night_2k.jpg',
  tex => {
    tex.mapping = THREE.EquirectangularReflectionMapping;
    scene.background = tex;
    scene.environment = tex;
  }
);

const gltfLoader = new THREE.GLTFLoader();
const targetDistance = 10;
const pickableObjects = [];
let selectedObject = null;
let mixerSkill = null;
const labelDiv = document.getElementById("label");

// === ‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏°‡πÄ‡∏î‡∏• ===
gltfLoader.load('https://raw.githubusercontent.com/Dechachai05/Portfolio/main/myname1.glb', (gltf) => {
  const model = gltf.scene;
  model.scale.set(0.15, 0.15, 0.15);
  model.position.set(-targetDistance, 0.5, -targetDistance);
  model.name = "About Me";
  scene.add(model);
  pickableObjects.push(model);
});

gltfLoader.load('https://raw.githubusercontent.com/Dechachai05/Portfolio/main/skill1.glb', (gltf) => {
  const skillModel = gltf.scene;
  skillModel.scale.set(0.2, 0.2, 0.2);
  skillModel.position.set(targetDistance, 0.5, -targetDistance);
  skillModel.name = "skill";
  scene.add(skillModel);
  pickableObjects.push(skillModel);

  if (gltf.animations.length > 0) {
    mixerSkill = new THREE.AnimationMixer(skillModel);
    const danceAction = mixerSkill.clipAction(gltf.animations[0]);
    danceAction.play();
  }
});

gltfLoader.load('https://raw.githubusercontent.com/Dechachai05/Portfolio/main/contact.glb', (gltf) => {
  const model4 = gltf.scene;
  model4.scale.set(0.15, 0.15, 0.15);
  model4.position.set(targetDistance, 0.5, targetDistance);
  model4.name = "Contact";
  scene.add(model4);
  pickableObjects.push(model4);
});

// === Torus Cell Shader ‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á ===
const uniforms = {
  uTime: { value: 0.0 },
  uLightDir: { value: new THREE.Vector3(0.4,1.0,0.8).normalize() }
};

const vert = `
  uniform float uTime;
  varying vec3 vNormal;
  varying vec3 vPosW;

  void main(){
    vNormal = normalize(mat3(modelMatrix) * normal);
    vec3 pos = position;
    pos.z += sin(uTime + pos.x*2.0) * 0.1; // ‡∏Ç‡∏¢‡∏±‡∏ö‡∏Ç‡∏∂‡πâ‡∏ô‡∏•‡∏á
    vPosW = (modelMatrix * vec4(pos, 1.0)).xyz;
    gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);
  }
`;

const frag = `
  precision mediump float;
  varying vec3 vNormal;
  uniform vec3 uLightDir;
  varying vec3 vPosW;

  void main()
  {
    float diffuse = max(dot(vNormal, uLightDir), 0.0);
    float levels = 4.0;
    diffuse = floor(diffuse * levels) / levels;

    vec3 R = reflect(-uLightDir, vNormal);
    vec3 V = normalize(cameraPosition - vPosW);
    float specular = clamp(pow(dot(R,V), 4.0),0.0,1.0);
    specular = smoothstep(0.45,0.55,specular);
    specular *= diffuse;

    vec3 base = vec3(1.0, 1.0, 0.0); // ‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á
    vec3 color = (base * diffuse) + vec3(specular);

    gl_FragColor = vec4(color, 1.0);
  }
`;

const cellMat = new THREE.ShaderMaterial({ vertexShader: vert, fragmentShader: frag, uniforms });
const cellGeo = new THREE.TorusBufferGeometry(0.7, 0.2, 16, 32);
const cellMesh = new THREE.Mesh(cellGeo, cellMat);
cellMesh.position.set(-targetDistance, 1, targetDistance);
cellMesh.name = "Torus Cell Shader";
scene.add(cellMesh);
pickableObjects.push(cellMesh);

// === Camera Presets ===
const LERP = 0.08;
const targetCamPos = new THREE.Vector3().copy(camera.position);
const targetCtrlTarget = new THREE.Vector3().copy(controls.target);

const presets = {
  "About Me": [new THREE.Vector3(-targetDistance + 0.5, 0.8, -targetDistance + 4.0), new THREE.Vector3(-targetDistance, 0.2, -targetDistance)],
  "skill": [new THREE.Vector3(targetDistance + 3, 1.5, -targetDistance + 5), new THREE.Vector3(targetDistance, 1, -targetDistance)],
  "Project": [new THREE.Vector3(-targetDistance + 3, 1.5, targetDistance + 5), new THREE.Vector3(-targetDistance, 1, targetDistance)],
  "Contact": [new THREE.Vector3(targetDistance + 1.0, 1.0, targetDistance + 2.0), new THREE.Vector3(targetDistance, 0.5, targetDistance)],
  "Torus Cell Shader": [new THREE.Vector3(-targetDistance + 3, 1.5, targetDistance + 5), new THREE.Vector3(-targetDistance, 1, targetDistance)]
};

function setCamTarget(name) {
  if (presets[name]) {
    targetCamPos.copy(presets[name][0]);
    targetCtrlTarget.copy(presets[name][1]);
  }
}

// === Interaction ===
window.addEventListener('click', (event) => {
  const mouse = new THREE.Vector2(
    (event.clientX / window.innerWidth) * 2 - 1,
    -(event.clientY / window.innerHeight) * 2 + 1
  );
  const raycaster = new THREE.Raycaster();
  raycaster.setFromCamera(mouse, camera);
  const intersects = raycaster.intersectObjects(pickableObjects, true);
  if (intersects.length > 0) {
    const obj = intersects[0].object;
    selectedObject = obj;
    labelDiv.innerText = obj.name;
    setCamTarget(obj.name);
  }
});

document.getElementById('navbar').addEventListener('click', (event) => {
  const map = { "1":"About Me", "2":"skill", "3":"Project", "4":"Contact" };
  const name = map[event.target.dataset.target];
  if (name) {
    setCamTarget(name);
    labelDiv.innerText = name;
  }
});

// === Loop ===
const clock = new THREE.Clock();
(function loop() {
  const delta = clock.getDelta();
  const t = clock.getElapsedTime();
  if (mixerSkill) mixerSkill.update(delta);

  uniforms.uTime.value = t;
  uniforms.uLightDir.value.set(
    Math.sin(t * 0.7) * 2.0,
    Math.cos(t),
    Math.sin(t * 0.7)
  ).normalize();

  // ‡∏´‡∏°‡∏∏‡∏ô torus
  cellMesh.rotation.y += 0.01;
  cellMesh.rotation.x += 0.005;

  camera.position.lerp(targetCamPos, LERP);
  controls.target.lerp(targetCtrlTarget, LERP);
  controls.update();
  renderer.render(scene, camera);
  requestAnimationFrame(loop);
})();

addEventListener('resize', () => {
  camera.aspect = innerWidth / innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(innerWidth, innerHeight);
});

// ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏µ‡πà About Me
setCamTarget("About Me");
labelDiv.innerText = "About Me";
</script>
</body>
</html>
    
