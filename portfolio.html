<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="utf-8" />
    <title>3D Portfolio Stage - Close-up with 3D Background</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
        /* สไตล์พื้นฐาน */
        html, body { height: 100%; margin: 0; overflow: hidden; }
        canvas { display: block; }
        
        /* 1. Navigation Bar (ปุ่มเมนู) - สไตล์ Modern */
        #navbar {
            position: absolute;
            top: 25px;
            width: 100%;
            text-align: center;
            z-index: 100;
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            background-color: rgba(0, 0, 0, 0.4); 
            padding: 15px 0;
        }
        #navbar button {
            background: linear-gradient(145deg, #007bff, #0056b3); 
            color: white;
            font-family: 'Arial', sans-serif;
            font-weight: bold;
            font-size: 16px;
            border: none;
            padding: 12px 25px;
            margin: 0 8px;
            cursor: pointer;
            border-radius: 30px; 
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3); 
            transition: all 0.3s ease-in-out; 
        }
        #navbar button:hover {
            background: linear-gradient(145deg, #0056b3, #007bff); 
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.4); 
            transform: translateY(-2px); 
        }
        #navbar button:active {
            transform: translateY(0); 
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
</head>
<body>

    <div id="navbar">
        <button data-target="1">เกี่ยวกับฉัน</button>
        <button data-target="2">ทักษะ</button>
        <button data-target="3">ผลงาน</button>
        <button data-target="4">ติดต่อ</button>
    </div>
    
    <script>
        // --- 1. Scene / Camera / Renderer Setup ---
        const scene = new THREE.Scene();
        
        const camera = new THREE.PerspectiveCamera(60, innerWidth / innerHeight, 0.1, 100);
        camera.position.set(0, 1.2, 3);

        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(innerWidth, innerHeight);
        renderer.outputEncoding = THREE.sRGBEncoding;
        renderer.shadowMap.enabled = true;
        document.body.appendChild(renderer.domElement);

        const controls = new THREE.OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        controls.dampingFactor = 0.05;

        // --- 2. Lights (PBR Lighting) ---
        const hemi = new THREE.HemisphereLight(0xffffff, 0x111111, 0.5); 
        scene.add(hemi);

        const dir = new THREE.DirectionalLight(0xffffff, 1.5);
        dir.position.set(5, 10, 5);
        dir.castShadow = true;
        scene.add(dir);

        // --- 3. Ground (ฐานสีดำสะท้อน) ---
        const ground = new THREE.Mesh(
            new THREE.PlaneBufferGeometry(50, 50),
            new THREE.MeshStandardMaterial({ 
                color: 0x000000, // ฐานสีดำสนิท
                roughness: 0.15, 
                metalness: 0.8  
            })
        );
        ground.rotation.x = -Math.PI / 2;
        ground.receiveShadow = true;
        scene.add(ground);

        // --- 4. Environment Map (พื้นหลัง 3D) ---
        const ENV_MAP_URL = 'https://raw.githubusercontent.com/Dechachai05/Portfolio/main/dikhololo_night_2k.jpg';
        let envMap;

        new THREE.TextureLoader().load(ENV_MAP_URL, tex => {
            tex.mapping = THREE.EquirectangularReflectionMapping;
            scene.background = tex; 
            scene.environment = tex; 
        });
        
        // --- 5. GLTF Loader และ Model Setup ---
        const gltfLoader = new THREE.GLTFLoader();
        // **URL โมเดลชื่อใหม่ของคุณ**
        const MY_NAME_MODEL_URL = 'https://raw.githubusercontent.com/Dechachai05/Portfolio/main/myname1.glb';
        const targetDistance = 10;

        gltfLoader.load(
            MY_NAME_MODEL_URL,
            (gltf) => {
                const myNameModel = gltf.scene || gltf.scenes[0];
                myNameModel.traverse((node) => {
                    if (node.isMesh) {
                        node.castShadow = true;
                        node.receiveShadow = true;
                        if (node.material && (node.material.isMeshStandardMaterial || node.material.isMeshPhysicalMaterial)) {
                            node.material.envMap = envMap;
                            node.material.envMapIntensity = 1.5; 
                            node.material.metalness = 0.9; 
                            node.material.roughness = 0.2; 
                            node.material.needsUpdate = true;
                        }
                    }
                });

                myNameModel.scale.set(0.15, 0.15, 0.15); 
                myNameModel.position.set(-targetDistance, 0.5, -targetDistance); 
                
                scene.add(myNameModel);
            },
            undefined,
            (error) => {
                console.error('Error loading myname1.glb:', error);
            }
        );

        // 5.2. สร้างสี่เหลี่ยมเป้าหมายสำหรับมุมอื่นๆ (2, 3, 4)
        const boxSize = 2;
        const boxGeometry = new THREE.BoxGeometry(boxSize, boxSize, boxSize);
        const boxMaterial = new THREE.MeshStandardMaterial({ 
            color: 0x444444, 
            transparent: true, 
            opacity: 0.8,
            metalness: 0.8,
            roughness: 0.3
        });
        
        const boxPositions = [
            { id: '2', x: targetDistance, z: -targetDistance },
            { id: '3', x: -targetDistance, z: targetDistance },
            { id: '4', x: targetDistance, z: targetDistance }
        ];

        boxPositions.forEach(pos => {
            const box = new THREE.Mesh(boxGeometry, boxMaterial);
            box.position.set(pos.x, boxSize / 2, pos.z);
            scene.add(box);
        });

        // --- 6. LERP Camera Logic ---
        const LERP_FACTOR = 0.08; 
        const targetCameraPosition = new THREE.Vector3().copy(camera.position);
        const targetControlsTarget = new THREE.Vector3().copy(controls.target); 

        // ตำแหน่ง Close-up สำหรับมุม '1'
        const cameraPresets = {
            '1': [
                new THREE.Vector3(-targetDistance + 0.5, 0.8, -targetDistance + 4.0), 
                new THREE.Vector3(-targetDistance, 0.2, -targetDistance) 
            ], 
            '2': [new THREE.Vector3(targetDistance + 3, 1.5, -targetDistance + 5), new THREE.Vector3(targetDistance, 1, -targetDistance)],   
            '3': [new THREE.Vector3(-targetDistance + 3, 1.5, targetDistance + 5), new THREE.Vector3(-targetDistance, 1, targetDistance)], 
            '4': [new THREE.Vector3(targetDistance + 3, 1.5, targetDistance + 5), new THREE.Vector3(targetDistance, 1, targetDistance)]
        };

        function setCameraTarget(id) {
            if (cameraPresets[id]) {
                targetCameraPosition.copy(cameraPresets[id][0]);
                targetControlsTarget.copy(cameraPresets[id][1]);
            }
        }
        
        // --- 7. Animation Loop ---
        const clock = new THREE.Clock();
        let mixer = null;

        (function loop() {
            const delta = clock.getDelta();
            if (mixer) mixer.update(delta);

            camera.position.lerp(targetCameraPosition, LERP_FACTOR);
            controls.target.lerp(targetControlsTarget, LERP_FACTOR);
            
            controls.update();
            renderer.render(scene, camera);
            requestAnimationFrame(loop);
        })();
        
        // --- 8. Event Listeners ---
        document.getElementById('navbar').addEventListener('click', (event) => {
            const targetId = event.target.dataset.target;
            if (targetId) {
                setCameraTarget(targetId);
            }
        });

        addEventListener('resize', ()=>{
            camera.aspect = innerWidth/innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(innerWidth, innerHeight);
        });

        // ตั้งค่าเริ่มต้นของกล้องไปยังมุม 1 (โมเดลชื่อคุณ)
        setCameraTarget('1');
    </script>
</body>
</html> 
