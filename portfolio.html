<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="utf-8" />
<title>3D Portfolio Stage - Hulk Dancing in Skills</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
    html, body { height: 100%; margin: 0; overflow: hidden; }
    canvas { display: block; }

    #navbar {
        position: absolute;
        top: 25px;
        left: 25px;
        text-align: left;
        z-index: 100;
        padding: 15px;
        border-radius: 10px;
        background-color: rgba(0,0,0,0.6);
    }

    #navbar button {
        background: linear-gradient(145deg, #007bff, #0056b3);
        color: white;
        font-family: 'Arial', sans-serif;
        font-weight: bold;
        font-size: 16px;
        border: none;
        padding: 12px 25px;
        margin: 5px 0;
        cursor: pointer;
        border-radius: 30px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        transition: all 0.3s ease-in-out;
        display: block;
    }

    #navbar button:hover {
        background: linear-gradient(145deg, #0056b3, #007bff);
        box-shadow: 0 8px 15px rgba(0, 0, 0, 0.4);
        transform: translateY(-2px);
    }

    #navbar button:active {
        transform: translateY(0);
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
    }

    #label {
        position: absolute;
        bottom: 25px;
        left: 50%;
        transform: translateX(-50%);
        color: white;
        font-size: 24px;
        font-weight: bold;
        text-shadow: 0 0 10px black;
        z-index: 100;
    }

    #tip {
        position: absolute;
        top: 10px;
        left: 50%;
        transform: translateX(-50%);
        color: #ffd700;
        font-size: 20px;
        font-weight: bold;
        text-shadow: 0 0 10px black;
        animation: pulseTip 2s infinite;
        z-index: 100;
    }

    @keyframes pulseTip {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.5; }
    }
</style>

<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
</head>
<body>

<div id="navbar">
    <button data-target="1">About Me</button>
    <button data-target="2">‡∏ó‡∏±‡∏Å‡∏©‡∏∞</button>
    <button data-target="3">‡∏ú‡∏•‡∏á‡∏≤‡∏ô</button>
    <button data-target="4">Contact</button>
</div>

<div id="tip">üí° ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î!</div>
<div id="label">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏...</div>

<script>
const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera(60, innerWidth / innerHeight, 0.1, 100);
camera.position.set(0, 1.2, 3);

const renderer = new THREE.WebGLRenderer({ antialias: true });
renderer.setSize(innerWidth, innerHeight);
renderer.outputEncoding = THREE.sRGBEncoding;
renderer.shadowMap.enabled = true;
document.body.appendChild(renderer.domElement);

const controls = new THREE.OrbitControls(camera, renderer.domElement);
controls.enableDamping = true;
controls.dampingFactor = 0.05;

// Lights
const hemi = new THREE.HemisphereLight(0xffffff, 0x111111, 0.5);
scene.add(hemi);
const dir = new THREE.DirectionalLight(0xffffff, 1.5);
dir.position.set(5, 10, 5);
dir.castShadow = true;
scene.add(dir);

// Ground
const ground = new THREE.Mesh(
    new THREE.PlaneBufferGeometry(50, 50),
    new THREE.MeshStandardMaterial({ color: 0x000000, roughness: 0.15, metalness: 0.8 })
);
ground.rotation.x = -Math.PI / 2;
ground.receiveShadow = true;
scene.add(ground);

// Environment map
const ENV_MAP_URL = 'https://raw.githubusercontent.com/Dechachai05/Portfolio/main/dikhololo_night_2k.jpg';
new THREE.TextureLoader().load(ENV_MAP_URL, tex => {
    tex.mapping = THREE.EquirectangularReflectionMapping;
    scene.background = tex;
    scene.environment = tex;
});

const gltfLoader = new THREE.GLTFLoader();
const targetDistance = 10;
const pickableObjects = [];
let selectedObject = null;
const labelDiv = document.getElementById("label");

// Animation mixer ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Skill
let mixerSkill = null;

// ‡πÇ‡∏°‡πÄ‡∏î‡∏• About Me
gltfLoader.load(
    'https://raw.githubusercontent.com/Dechachai05/Portfolio/main/myname1.glb',
    (gltf) => {
        const model = gltf.scene;
        model.traverse(node => { if (node.isMesh) { node.castShadow = true; node.receiveShadow = true; } });
        model.scale.set(0.15, 0.15, 0.15);
        model.position.set(-targetDistance, 0.5, -targetDistance);
        model.name = "About Me";
        scene.add(model);
        pickableObjects.push(model);
    }
);

// ‡πÇ‡∏°‡πÄ‡∏î‡∏• Skills (Hulk ‡πÄ‡∏ï‡πâ‡∏ô)
gltfLoader.load(
    'https://raw.githubusercontent.com/Dechachai05/Portfolio/main/skill1.glb',
    (gltf) => {
        const skillModel = gltf.scene;
        skillModel.traverse(node => { if(node.isMesh){ node.castShadow=true; node.receiveShadow=true; } });
        skillModel.scale.set(0.2, 0.2, 0.2);
        skillModel.position.set(targetDistance, 0.5, -targetDistance);
        skillModel.name = "‡∏ó‡∏±‡∏Å‡∏©‡∏∞";
        scene.add(skillModel);
        pickableObjects.push(skillModel);

        // ‡πÄ‡∏•‡πà‡∏ô Animation ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ
        if (gltf.animations && gltf.animations.length > 0) {
            mixerSkill = new THREE.AnimationMixer(skillModel);
            const danceAction = mixerSkill.clipAction(gltf.animations[0]);
            danceAction.play();
        }
    }
);

// ‡πÇ‡∏°‡πÄ‡∏î‡∏• Contact
gltfLoader.load(
    'https://raw.githubusercontent.com/Dechachai05/Portfolio/main/contact.glb',
    (gltf) => {
        const model4 = gltf.scene;
        model4.scale.set(0.15, 0.15, 0.15);
        model4.position.set(targetDistance, 0.5, targetDistance);
        model4.name = "Contact";
        scene.add(model4);
        pickableObjects.push(model4);
    }
);

// ‡∏Å‡∏•‡πà‡∏≠‡∏á Portfolio
const boxSize = 2;
const boxGeometry = new THREE.BoxGeometry(boxSize, boxSize, boxSize);
const portfolioBox = new THREE.Mesh(
    boxGeometry,
    new THREE.MeshStandardMaterial({ color: 0x444444, metalness: 0.8, roughness: 0.3, emissive: 0x000000, emissiveIntensity: 0.5 })
);
portfolioBox.position.set(-targetDistance, 1, targetDistance);
portfolioBox.name = "‡∏ú‡∏•‡∏á‡∏≤‡∏ô";
scene.add(portfolioBox);
pickableObjects.push(portfolioBox);

// Camera presets
const LERP_FACTOR = 0.08;
const targetCameraPosition = new THREE.Vector3().copy(camera.position);
const targetControlsTarget = new THREE.Vector3().copy(controls.target);

const cameraPresetsByName = {
    "About Me": [new THREE.Vector3(-targetDistance + 0.5, 0.8, -targetDistance + 4.0), new THREE.Vector3(-targetDistance, 0.2, -targetDistance)],
    "‡∏ó‡∏±‡∏Å‡∏©‡∏∞": [new THREE.Vector3(targetDistance + 3, 1.5, -targetDistance + 5), new THREE.Vector3(targetDistance, 1, -targetDistance)],
    "‡∏ú‡∏•‡∏á‡∏≤‡∏ô": [new THREE.Vector3(-targetDistance + 3, 1.5, targetDistance + 5), new THREE.Vector3(-targetDistance, 1, targetDistance)],
    "Contact": [new THREE.Vector3(targetDistance + 1.0, 1.0, targetDistance + 2.0), new THREE.Vector3(targetDistance, 0.5, targetDistance)]
};

function setCameraTargetByName(name) {
    if (cameraPresetsByName[name]) {
        targetCameraPosition.copy(cameraPresetsByName[name][0]);
        targetControlsTarget.copy(cameraPresetsByName[name][1]);
    }
}

// Mouse click + picking + glow + label
function onMouseClick(event) {
    const mouse = new THREE.Vector2(
        (event.clientX / window.innerWidth) * 2 - 1,
        -(event.clientY / window.innerHeight) * 2 + 1
    );
    const raycaster = new THREE.Raycaster();
    raycaster.setFromCamera(mouse, camera);
    const intersects = raycaster.intersectObjects(pickableObjects, true);
    if (intersects.length > 0) {
        const obj = intersects[0].object;
        const objName = obj.name;

        // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡πÄ‡∏Å‡πà‡∏≤
        if (selectedObject && selectedObject.material) {
            selectedObject.material.color.setHex(selectedObject.originalColor);
            selectedObject.material.emissive.setHex(0x000000);
        }

        // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏µ‡πÄ‡∏î‡∏¥‡∏°
        if (!obj.originalColor && obj.material) obj.originalColor = obj.material.color.getHex();

        // Highlight
        if (obj.material) {
            obj.material.color.set(0xffaa00);
            obj.material.emissive.set(0xffaa00);
        }

        selectedObject = obj;
        labelDiv.innerText = objName;
        setCameraTargetByName(objName);
    }
}
window.addEventListener('click', onMouseClick);

// Navbar click
document.getElementById('navbar').addEventListener('click', (event) => {
    const targetId = event.target.dataset.target;
    if (targetId) {
        const mapping = { "1":"About Me","2":"‡∏ó‡∏±‡∏Å‡∏©‡∏∞","3":"‡∏ú‡∏•‡∏á‡∏≤‡∏ô","4":"Contact" };
        setCameraTargetByName(mapping[targetId]);
        labelDiv.innerText = mapping[targetId];
    }
});

// Loop + Animation + Glow pulse
const clock = new THREE.Clock();
(function loop() {
    const delta = clock.getDelta();
    if (mixerSkill) mixerSkill.update(delta); // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï Animation Hulk

    const t = clock.getElapsedTime();
    if (selectedObject && selectedObject.material) {
        selectedObject.material.emissiveIntensity = 0.5 + 0.5 * Math.sin(t * 3);
    }

    camera.position.lerp(targetCameraPosition, LERP_FACTOR);
    controls.target.lerp(targetControlsTarget, LERP_FACTOR);
    controls.update();
    renderer.render(scene, camera);
    requestAnimationFrame(loop);
})();

addEventListener('resize', () => {
    camera.aspect = innerWidth / innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(innerWidth, innerHeight);
});

// ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏µ‡πà About Me
setCameraTargetByName("About Me");
labelDiv.innerText = "About Me";
</script>

</body>
</html>
